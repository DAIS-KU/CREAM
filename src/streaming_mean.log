nohup: ignoring input
Running experiments: streaming_mean
Start session: 0
End session: 1
Load cluster: False
Use cluster warming up: stream_seed
Use label: False
Use weight: False
Use tensor key: True
Use nbits: 12
Use max_iters: 3
Use warmingup_rate: None
Use warmingup_k: 5
Use cluster_min_size: 50
Use required_doc_size: 50
Use stream sampling rate: None
Use sampling size per query: 50
Number of Epochs: 1
Include answer: False
Training Session 0/False
queries:400, docs:11266
queries:400, documents:11266
Query mean-pooling embedding starts.
 process_batch(cuda:0) 0/400
Document mean-pooling embedding starts..
 process_batch(cuda:0) 0/11266
 process_batch(cuda:0) 2048/11266
 process_batch(cuda:0) 4096/11266
 process_batch(cuda:0) 6144/11266
 process_batch(cuda:0) 8192/11266
 process_batch(cuda:0) 10240/11266
query_list:400, doc_list:11266
queries #400, documents #11666 initial_docs #0
#doc_stream 12, stream_docs size 402-1024
Session 0 | Document count:11666
Document mean-pooling embedding starts..
 process_batch(cuda:0) 0/1024
Initialize centroid
Starting iteration 1 | centroids: #5
cuda:0 | get_closest_clusters batch (0/4)
get_closest_clusters batch_tensor:torch.Size([256, 768]), centroids_tensor:torch.Size([5, 768])
cuda:0 | get_closest_clusters batch (1/4)
get_closest_clusters batch_tensor:torch.Size([256, 768]), centroids_tensor:torch.Size([5, 768])
cuda:0 | get_closest_clusters batch (2/4)
get_closest_clusters batch_tensor:torch.Size([256, 768]), centroids_tensor:torch.Size([5, 768])
cuda:0 | get_closest_clusters batch (3/4)
get_closest_clusters batch_tensor:torch.Size([256, 768]), centroids_tensor:torch.Size([5, 768])
clsuter 0 create new centroid.(instance 383)
clsuter 1 create new centroid.(instance 29)
clsuter 2 create new centroid.(instance 161)
clsuter 3 create new centroid.(instance 286)
clsuter 4 create new centroid.(instance 165)
iter_num 0 | execution_time: 0.04711103439331055 sec.
Starting iteration 2 | centroids: #5
cuda:0 | get_closest_clusters batch (0/4)
get_closest_clusters batch_tensor:torch.Size([256, 768]), centroids_tensor:torch.Size([5, 768])
cuda:0 | get_closest_clusters batch (1/4)
get_closest_clusters batch_tensor:torch.Size([256, 768]), centroids_tensor:torch.Size([5, 768])
cuda:0 | get_closest_clusters batch (2/4)
get_closest_clusters batch_tensor:torch.Size([256, 768]), centroids_tensor:torch.Size([5, 768])
cuda:0 | get_closest_clusters batch (3/4)
get_closest_clusters batch_tensor:torch.Size([256, 768]), centroids_tensor:torch.Size([5, 768])
clsuter 0 create new centroid.(instance 304)
clsuter 1 create new centroid.(instance 64)
clsuter 2 create new centroid.(instance 237)
clsuter 3 create new centroid.(instance 217)
clsuter 4 create new centroid.(instance 202)
iter_num 1 | execution_time: 0.009248971939086914 sec.
Starting iteration 3 | centroids: #5
cuda:0 | get_closest_clusters batch (0/4)
get_closest_clusters batch_tensor:torch.Size([256, 768]), centroids_tensor:torch.Size([5, 768])
cuda:0 | get_closest_clusters batch (1/4)
get_closest_clusters batch_tensor:torch.Size([256, 768]), centroids_tensor:torch.Size([5, 768])
cuda:0 | get_closest_clusters batch (2/4)
get_closest_clusters batch_tensor:torch.Size([256, 768]), centroids_tensor:torch.Size([5, 768])
cuda:0 | get_closest_clusters batch (3/4)
get_closest_clusters batch_tensor:torch.Size([256, 768]), centroids_tensor:torch.Size([5, 768])
clsuter 0 create new centroid.(instance 273)
clsuter 1 create new centroid.(instance 100)
clsuter 2 create new centroid.(instance 266)
clsuter 3 create new centroid.(instance 169)
clsuter 4 create new centroid.(instance 216)
iter_num 2 | execution_time: 0.009109020233154297 sec.
cluster 0 size: 273
cluster 1 size: 100
cluster 2 size: 266
cluster 3 size: 169
cluster 4 size: 216
centroids : 5
Create 0th Cluster.
Create 1th Cluster.
Create 2th Cluster.
Create 3th Cluster.
Create 4th Cluster.
Spend 1.616577386856079 seconds for clustering(5, 1024) warming up.
Assign 1th stream starts.
assign_instance_or_add_cluster_doc2cluster started.
assign_instance_or_add_cluster_doc2cluster | batch_cnt: 1 | num_devices: 1, stream_docs:1024
ㄴ Batch 1024 starts on cuda:0.
assign_instance_or_add_cluster_doc2cluster finished.(5)
Assign 1th stream ended(0.15378713607788086sec).
Assign 2th stream starts.
assign_instance_or_add_cluster_doc2cluster started.
assign_instance_or_add_cluster_doc2cluster | batch_cnt: 1 | num_devices: 1, stream_docs:1024
ㄴ Batch 1024 starts on cuda:0.
closest_cluster: 92.4761254787445, 16.598074536971275, 546
closest_distance: 0.503940224647522, closest_boundary:0.5004911088157484
assign_instance_or_add_cluster_doc2cluster finished.(6)
Assign 2th stream ended(0.12875962257385254sec).
Assign 3th stream starts.
assign_instance_or_add_cluster_doc2cluster started.
assign_instance_or_add_cluster_doc2cluster | batch_cnt: 1 | num_devices: 1, stream_docs:1024
ㄴ Batch 1024 starts on cuda:0.
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.37962156534194946, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.4302738904953003, closest_boundary:0.0
assign_instance_or_add_cluster_doc2cluster finished.(8)
Assign 3th stream ended(0.15137553215026855sec).
Assign 4th stream starts.
assign_instance_or_add_cluster_doc2cluster started.
assign_instance_or_add_cluster_doc2cluster | batch_cnt: 1 | num_devices: 1, stream_docs:1024
ㄴ Batch 1024 starts on cuda:0.
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.14381897449493408, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.35723692178726196, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.4796278476715088, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.4021573066711426, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3496466875076294, closest_boundary:0.0
assign_instance_or_add_cluster_doc2cluster finished.(13)
Assign 4th stream ended(0.16753721237182617sec).
Assign 5th stream starts.
assign_instance_or_add_cluster_doc2cluster started.
assign_instance_or_add_cluster_doc2cluster | batch_cnt: 1 | num_devices: 1, stream_docs:1024
ㄴ Batch 1024 starts on cuda:0.
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3031644821166992, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.34810811281204224, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.36707407236099243, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.40212422609329224, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3854217529296875, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3477558493614197, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.35304874181747437, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.39547401666641235, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.32608461380004883, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.328646719455719, closest_boundary:0.0
assign_instance_or_add_cluster_doc2cluster finished.(23)
Assign 5th stream ended(0.16784930229187012sec).
Assign 6th stream starts.
assign_instance_or_add_cluster_doc2cluster started.
assign_instance_or_add_cluster_doc2cluster | batch_cnt: 1 | num_devices: 1, stream_docs:1024
ㄴ Batch 1024 starts on cuda:0.
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.1276792287826538, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2936885952949524, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.1721101999282837, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.22683262825012207, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3312835693359375, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.43124252557754517, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.48314064741134644, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3293796181678772, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2882956862449646, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3325989246368408, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.28762316703796387, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.21514183282852173, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.25543373823165894, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.26486241817474365, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.34058552980422974, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.19069260358810425, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2579233646392822, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.24048292636871338, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3485819697380066, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.33991342782974243, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.13983392715454102, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.1598711609840393, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.29153984785079956, closest_boundary:0.0
assign_instance_or_add_cluster_doc2cluster finished.(46)
Assign 6th stream ended(0.19876575469970703sec).
Assign 7th stream starts.
assign_instance_or_add_cluster_doc2cluster started.
assign_instance_or_add_cluster_doc2cluster | batch_cnt: 1 | num_devices: 1, stream_docs:1024
ㄴ Batch 1024 starts on cuda:0.
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2938661575317383, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.21822881698608398, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.20934975147247314, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.19217318296432495, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.23831313848495483, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3297466039657593, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.36167001724243164, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3077901005744934, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3913500905036926, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.259029746055603, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.22614967823028564, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.20551156997680664, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.19036298990249634, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3694079518318176, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2705966830253601, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.243782639503479, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.297374963760376, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.4482916593551636, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.18237757682800293, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.13779258728027344, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2775213122367859, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.24889719486236572, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.19583994150161743, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.22483378648757935, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.26438695192337036, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2361522912979126, closest_boundary:0.0
assign_instance_or_add_cluster_doc2cluster finished.(72)
Assign 7th stream ended(0.20813560485839844sec).
Assign 8th stream starts.
assign_instance_or_add_cluster_doc2cluster started.
assign_instance_or_add_cluster_doc2cluster | batch_cnt: 1 | num_devices: 1, stream_docs:1024
ㄴ Batch 1024 starts on cuda:0.
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.06885552406311035, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2677208185195923, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.32805508375167847, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.36302220821380615, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2076730728149414, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3563072681427002, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.22849178314208984, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.344130277633667, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2794712781906128, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.25060760974884033, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2685520052909851, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2575523257255554, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2840890884399414, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.1163286566734314, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.32550048828125, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.12192928791046143, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.1701723337173462, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.22793936729431152, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.12073010206222534, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3091573119163513, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3033900856971741, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.31718868017196655, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.29904770851135254, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.16559410095214844, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2204555869102478, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.29150938987731934, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.24676531553268433, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2142953872680664, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.32570910453796387, closest_boundary:0.0
assign_instance_or_add_cluster_doc2cluster finished.(101)
Assign 8th stream ended(0.301588773727417sec).
Assign 9th stream starts.
assign_instance_or_add_cluster_doc2cluster started.
assign_instance_or_add_cluster_doc2cluster | batch_cnt: 1 | num_devices: 1, stream_docs:1024
ㄴ Batch 1024 starts on cuda:0.
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.23709166049957275, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.26591718196868896, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.16057103872299194, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.13431233167648315, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.0816342830657959, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.15335309505462646, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.21833717823028564, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3052014112472534, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.216303288936615, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.30429530143737793, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.20083653926849365, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.28192758560180664, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.24075233936309814, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.31854259967803955, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.26373153924942017, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.16910243034362793, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2674521803855896, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.1092909574508667, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2820417284965515, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3279651403427124, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.19935214519500732, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.24197924137115479, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.30819422006607056, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3140948414802551, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.19988411664962769, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.16831034421920776, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3363224267959595, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2806578278541565, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.17298287153244019, closest_boundary:0.0
assign_instance_or_add_cluster_doc2cluster finished.(130)
Assign 9th stream ended(0.27143406867980957sec).
Assign 10th stream starts.
assign_instance_or_add_cluster_doc2cluster started.
assign_instance_or_add_cluster_doc2cluster | batch_cnt: 1 | num_devices: 1, stream_docs:1024
ㄴ Batch 1024 starts on cuda:0.
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.23183441162109375, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2827947735786438, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2288447618484497, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2692878246307373, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3002163767814636, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2292690873146057, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.14349734783172607, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.30479955673217773, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.1983744502067566, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2262202501296997, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.23467886447906494, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.24129951000213623, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.23616695404052734, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.27043789625167847, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.10253864526748657, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.29347556829452515, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.40890735387802124, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2758805751800537, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.23629486560821533, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.24079042673110962, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.17498528957366943, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.12311029434204102, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.33100664615631104, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.25064587593078613, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.17733502388000488, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2401411533355713, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3466496467590332, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2442449927330017, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2829272150993347, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2123010754585266, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.3737335205078125, closest_boundary:0.0
assign_instance_or_add_cluster_doc2cluster finished.(161)
Assign 10th stream ended(0.33490419387817383sec).
Assign 11th stream starts.
assign_instance_or_add_cluster_doc2cluster started.
assign_instance_or_add_cluster_doc2cluster | batch_cnt: 1 | num_devices: 1, stream_docs:402
ㄴ Batch 402 starts on cuda:0.
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.029401302337646484, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2919408679008484, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.27322787046432495, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.24733883142471313, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2384076714515686, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.26437413692474365, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.30533361434936523, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.14058178663253784, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.08003151416778564, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.30046844482421875, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.26453715562820435, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.4340357184410095, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.29263192415237427, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.2438124418258667, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.24030596017837524, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.25312578678131104, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.23027217388153076, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.19840562343597412, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.09255295991897583, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.27444690465927124, closest_boundary:0.0
closest_cluster: 0.0, 0.0, 1
closest_distance: 0.11161243915557861, closest_boundary:0.0
assign_instance_or_add_cluster_doc2cluster finished.(182)
Assign 11th stream ended(0.08477401733398438sec).
Summary: {'num_evaluated_queries': 400, 'macro_recall': 0.095, 'micro_recall': 0.09285714285714286, 'success@1_rate': 0.095}
Document only #2626
Document only #1844
Document only #2621
Document only #1333
Document only #2841
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #1
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Document only #0
Clear invalid clusters #182 -> #5
evict_cluster_instances started.
Query only #12/2638
BOUNDARY: 0.17837105824721625| mean:0.1684835772789094, std:0.03954992387322737, z1:8.0, z2:0.25, n:2638
BOUNDARY: 0.17837105824721625| batch_doc_embs min/max:0.9999997019767761, 1.0000001192092896
BOUNDARY: 0.17837105824721625| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
BOUNDARY: 0.17837105824721625| batch_doc_embs min/max:0.9999997615814209, 1.0000001192092896
BOUNDARY: 0.17837105824721625| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
BOUNDARY: 0.17837105824721625| batch_doc_embs min/max:0.9999997615814209, 1.0000001192092896
BOUNDARY: 0.17837105824721625| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
BOUNDARY: 0.17837105824721625| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
doc_ids# 2638 -> 1687 | prototype is nan False
Query only #1/1845
BOUNDARY: 0.17585273257057357| mean:0.16622945813305656, std:0.03849309775006801, z1:8.0, z2:0.25, n:1845
BOUNDARY: 0.17585273257057357| batch_doc_embs min/max:0.9999998211860657, 1.000000238418579
BOUNDARY: 0.17585273257057357| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
BOUNDARY: 0.17585273257057357| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
BOUNDARY: 0.17585273257057357| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
BOUNDARY: 0.17585273257057357| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
doc_ids# 1845 -> 1224 | prototype is nan False
Query only #145/2766
BOUNDARY: 0.18955452318447472| mean:0.17529731148494299, std:0.0570288467981269, z1:8.0, z2:0.25, n:2766
BOUNDARY: 0.18955452318447472| batch_doc_embs min/max:0.9999997615814209, 1.0000001192092896
BOUNDARY: 0.18955452318447472| batch_doc_embs min/max:0.9999997615814209, 1.0000001192092896
BOUNDARY: 0.18955452318447472| batch_doc_embs min/max:0.9999998211860657, 1.000000238418579
BOUNDARY: 0.18955452318447472| batch_doc_embs min/max:0.9999997615814209, 1.000000238418579
BOUNDARY: 0.18955452318447472| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
BOUNDARY: 0.18955452318447472| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
BOUNDARY: 0.18955452318447472| batch_doc_embs min/max:0.9999998211860657, 1.000000238418579
BOUNDARY: 0.18955452318447472| batch_doc_embs min/max:0.9999997615814209, 1.0000001192092896
doc_ids# 2766 -> 2060 | prototype is nan False
Query only #48/1381
BOUNDARY: 0.17405459502352716| mean:0.15979957895638025, std:0.0570200642685876, z1:8.0, z2:0.25, n:1381
BOUNDARY: 0.17405459502352716| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
BOUNDARY: 0.17405459502352716| batch_doc_embs min/max:0.9999998211860657, 1.000000238418579
BOUNDARY: 0.17405459502352716| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
BOUNDARY: 0.17405459502352716| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
doc_ids# 1381 -> 928 | prototype is nan False
Query only #18/2859
BOUNDARY: 0.19474269796562352| mean:0.1840493010657365, std:0.04277358759954813, z1:8.0, z2:0.25, n:2859
BOUNDARY: 0.19474269796562352| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
BOUNDARY: 0.19474269796562352| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
BOUNDARY: 0.19474269796562352| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
BOUNDARY: 0.19474269796562352| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
BOUNDARY: 0.19474269796562352| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
BOUNDARY: 0.19474269796562352| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
BOUNDARY: 0.19474269796562352| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
BOUNDARY: 0.19474269796562352| batch_doc_embs min/max:0.9999998211860657, 1.0000001192092896
doc_ids# 2859 -> 1924 | prototype is nan False
evict_cluster_instances finished. (left #5)
clear_unused_documents | before total #11666
clear_unused_documents | after total #7823
